<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <title>Barcelona Temperatuur Visualisatie</title>
        <style>
            body {
                margin: 0;
                overflow: hidden;
            }
            canvas {
                display: block;
            }
            #info {
                position: absolute;
                top: 10px;
                left: 10px;
                background: rgba(0, 0, 0, 0.6);
                color: white;
                padding: 10px;
                font-family: sans-serif;
                font-size: 14px;
                max-width: 250px;
            }
        </style>
    </head>
    <body>
        <div id="info">Laden...</div>

        <!-- ‚úÖ ENKEL DIT SCRIPT - gebruik g√©√©n andere script tags! -->
        <script type="module">
            import * as THREE from 'https://jspm.dev/three';
            import {OrbitControls} from 'https://jspm.dev/three/examples/jsm/controls/OrbitControls.js';
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0x101010);

            const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera
                .position
                .set(0, 20, 60);

            const renderer = new THREE.WebGLRenderer({antialias: true});
            renderer.setSize(window.innerWidth, window.innerHeight);
            document
                .body
                .appendChild(renderer.domElement);

            const controls = new OrbitControls(camera, renderer.domElement);

            const light = new THREE.PointLight(0xffffff, 1);
            light
                .position
                .set(10, 20, 10);
            scene.add(light);

            const ambient = new THREE.AmbientLight(0x404040);
            scene.add(ambient);

            const info = document.getElementById("info");

            async function getWeatherData() {
                const url = "https://api.open-meteo.com/v1/forecast?latitude=41.3888&longitude=2.159&hourly=temperature_2m&timezone=auto&timeformat=unixtime";
                const res = await fetch(url);
                const data = await res.json();
                return data.hourly;
            }

            function createTemperatureGraph(times, temps) {
                const points = [];
                const maxTemp = Math.max(...temps);
                const minTemp = Math.min(...temps);

                for (let i = 0; i < temps.length; i++) {
                    points.push(new THREE.Vector3(i - temps.length / 2, temps[i], 0));
                }

                const geometry = new THREE
                    .BufferGeometry()
                    .setFromPoints(points);
                const material = new THREE.LineBasicMaterial({color: 0xffcc00});
                const line = new THREE.Line(geometry, material);
                scene.add(line);

                const axesHelper = new THREE.AxesHelper(30);
                scene.add(axesHelper);

                info.innerHTML = `
        üå§Ô∏è <strong>Temperatuur Barcelona (Live Data)</strong><br>
        üìà Hoogste: ${maxTemp}¬∞C<br>
        üìâ Laagste: ${minTemp}¬∞C<br>
        ‚è±Ô∏è Uren vooruit: ${temps.length}<br>
        üîó <a href="https://open-meteo.com/" target="_blank" style="color:#ffd;">Bron: open-meteo.com</a><br>
        üîÑ Update: realtime bij herladen
      `;
            }

            getWeatherData().then(data => {
                createTemperatureGraph(data.time, data.temperature_2m);
            });

            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });

            function animate() {
                requestAnimationFrame(animate);
                controls.update();
                renderer.render(scene, camera);
            }
            animate();
        </script>
    </body>
</html>